<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <div id="app">
    <div class="content">
      <input type="button" value="点击报错" onclick="a()" />
    </div>
    <!-- <img src="hij.png" alt=""> -->
  </div>

  <script>
    function a () {
      // === js 总共有7种错误 ===

      // 【Error 普通报错】: 主要是供开发者自定义抛出错误
      // throw new Error('abc')

      // 【SyntaxError 语法报错】常见的有：命名错误、缺少括号
      // var 1a
      // console.log('aaa'
      // JSON.parse('abc')

      // 【ReferenceError 引用报错】: 引用了不存在的变量
      // console.log(b)

      // 【TypeError 类型报错】：参数不是预期的类型
      // new 123
      // [1, 2].split(',')

      // 【RangeError 超出有效范围报错】: 数组长度为负数、堆栈超出最大值
      // new Array(-1)

      // 【URIError URI相关的函数报错】：常见的函数有 encodeURI、decodeURI、encodeURIComponent、decodeURIComponent、escape、unescape
      // decodeURI('%2')

      // 【EvalError eval 解析报错】：此种报错已经不会在 es5之后出现了，日常开发也不会遇到了


      // === promise 报错 ===
      // new Promise((resolve, reject) => {
        // reject({a: 1})
        // throw new Error('abc')
      // })

      // === ajax 报错 ===
      const xhr = new XMLHttpRequest()
      xhr.onreadystatechange = function (e) {
        // e.type = 'readystatechange'
        console.log('【onreadystatechange】 ==>', xhr.readyState, xhr)
        console.log('【onreadystatechange】 e ->', e)
      }
      xhr.open('GET', '/demo')
      
      // xhr.timeout = 2000

      // xhr.responseType = 'text'
      // xhr.responseType = 'json'
      // xhr.responseType = 'blob'
      xhr.responseType = 'arraybuffer'
      // xhr.responseType = 'document'

      xhr.addEventListener('abort', function (e) {
        // e.type = 'abort'
        console.log('【abort】e ->', e)
        console.log('【abort】xhr ->', xhr)
      }, false)

      xhr.addEventListener('timeout', function (e) {
        // e.type = 'timeout'
        console.log('【timeout】e ->', e)
        console.log('【timeout】xhr ->', xhr)
      }, false)

      xhr.addEventListener('error', function (e) {
        // e.type = 'error'
        console.log('【error】e ->', e)
        console.log('【error】xhr ->', xhr)
      }, false)

      xhr.addEventListener('load', function (e) {
        console.log('【load】e ->', e)
        console.log('【load】xhr ->', xhr)
        console.log('【load】type ->', typeof xhr.response)
        console.log('【load】response ->', xhr.response)

        if (xhr.responseType === 'blob') {
          const fileReader = new FileReader()
          fileReader.onload = function () {
            console.log('blob result ->', this.result)
          }
          fileReader.readAsText(xhr.response)
        } else if (xhr.responseType === 'arraybuffer') {
          const decoder = new TextDecoder()
          console.log('arraybuffer result ->', decoder.decode(xhr.response))
        }
        
        // console.log('【load】responseText ->', xhr.responseText)
        // console.log('【load】responseXML ->', xhr.responseXML)
      }, false)

      xhr.addEventListener('loadend', function (e) {
        // e.type = 'loadend'
        console.log('【onloaded】 e ->', e)
      }, false)
      
      xhr.send(JSON.stringify({name: 'hw'}))

      // setTimeout(() => {
      //   xhr.abort()
      // }, 2000)
    }

    // a()
    
  </script>
  <!-- <script src="abc.js"></script> -->
  <!-- <link rel="stylesheet" href="efg.css"> -->
</body>
</html>